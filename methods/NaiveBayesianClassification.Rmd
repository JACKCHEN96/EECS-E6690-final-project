---
title: "NaiveBayesianClassification"
author: "hz2619"
date: "12/8/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## import xlsx and make label
```{r}
library(readxl)
data1 <- read_xlsx("../data/1415CSM_dataset.xlsx")
i=1
asLabel=""
for (val in data1$Ratings) {
  if(val<=4.9){
    asLabel[i]="Poor"
  }else if(val<=6.4){
    asLabel[i]="Average"
  }else if(val<=8.9){
    asLabel[i]="Good"
  }else if(val<=10){
    asLabel[i]="Excellent"
  }
  i=i+1
}
data1 = data.frame(data1,asLabel)
data1 
```

## split the whole dataset into train and test dataset (80% : 20%)
```{r}
set.seed(10) ## Randomize
data1 = data.frame(data1,asLabel)
datasize = dim(data1)[1]
train_idx = sample(datasize, datasize*0.8)
indicator1 = rep(0,datasize)
indicator1[train_idx] = 1 ## 1:train 0:valid
data1 = data.frame(data1,indicator1)
train = subset(data1,data1$indicator1==1)
test = subset(data1,data1$indicator1==0)
```

## Brief about Train and Test Dataset
```{r}
summary(train)
summary(test)
```
```{r}
library(caret)
library(e1071)
NBclassfier = naiveBayes(asLabel ~ Genre+Gross+Budget+Screens+Sequel+Sentiment, data = train)
print(NBclassfier)
predict(NBclassfier, newdata = test)
summary(predict(NBclassfier, newdata = test))
```
